  
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<title></title>
</head>
<body>
<!-- Load TensorFlow.js. This is required to use MobileNet. -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"> </script>
<!-- Load the MobileNet model. -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@1.0.0"> </script>

<script src="talkify.min.js"></script>

<!-- Replace this with your image. Make sure CORS settings allow reading the image! -->
<video class="video" width="50%" height="50%" id="video" autoplay="true" playsinline></video>
<h1 id="message"> </h1>
<!-- Place your code in the script tag below. You can also use an external .js file -->
<script>
  // Notice there is no 'import' statement. 'mobilenet' and 'tf' is
  // available on the index-page because of the script tag above.

  var getJSON = function(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'json';
    xhr.onload = function() {
      var status = xhr.status;
      if (status === 200) {
        callback(null, xhr.response);
      } else {
        callback(status, xhr.response);
      }
    };
    xhr.send();
};

  const video = document.getElementById('video');
  
  if (navigator.mediaDevices.getUserMedia) {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function (stream) {
        video.srcObject = stream;
      })
      .catch(function (err0r) {
        console.log("Something went wrong!");
      });
  }

  video.onloadeddata = (event) => {
  // Load the model.
  mobilenet.load().then((net) => {
    console.log("Model loaded to memory!");
    // Step 2: Grab and classify
    net.classify(video).then((result) => {
      // Step 3: Print top result

      talkify.config.remoteService.active = true;
      talkify.config.remoteService.host = 'https://talkify.net';
      talkify.config.remoteService.apiKey = '46b32f4e-6b73-40ee-8ae1-4a17cb1b18f6';
      var player = new talkify.Html5Player()
                      .forceLanguage("en-US");
      var player2 = new talkify.Html5Player()
                      .forceLanguage("en-US");
      
      getJSON('https://api.dictionaryapi.dev/api/v2/entries/en_US/'+result[0].className.split(",")[0].replace(/\s/g, ''), function(err, data) {
        // JSON result in `data` variable
        document.getElementById("message").innerText = `
        Probability: ${result[0].probability}
        Detected: ${result[0].className.split(",")[0].replace(/\s/g, '')}       
        Definition: ${data[0].meanings[0].definitions[0].definition}`;
        player.playText(`${result[0].className.split(",")[0].replace(/\s/g, '')}`);
        player2.playText(`${data[0].meanings[0].definitions[0].definition}`);
      });

    });
  });
  };


</script>
</body>
</html>